<!-- index.html no GitHub Pages -->
<!DOCTYPE html>
<html>
<body>
<canvas id="tela"></canvas>

<script>
// Pega room da URL
const urlParams = new URLSearchParams(window.location.search);
const roomId = urlParams.get('room');

if (!roomId) {
    document.body.innerHTML = '<h3>Acesso: ?room=ID_DO_ROOM</h3>';
} else {
    // Conecta P2P
    const ws = new WebSocket(`ws://localhost:8765`);
    const canvas = document.getElementById('tela');
    const ctx = canvas.getContext('2d');

    ws.onopen = () => {
        console.log(`Conectado P2P ao room: ${roomId}`);
    };

    ws.onmessage = (event) => {
        const data = JSON.parse(event.data);

        if (data.type === 'frame' && data.room === roomId) {
            const img = new Image();
            img.onload = () => {
                canvas.width = data.width;
                canvas.height = data.height;
                ctx.drawImage(img, 0, 0);
            };
            img.src = 'data:image/jpeg;base64,' + data.frame;
        }
    };
}
</script>
</body>
</html>
